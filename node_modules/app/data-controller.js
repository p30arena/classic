var proc = require('app/procedure');
var DB = require('app/database');
var bcrypt = require('bcrypt-nodejs');

function generate_token() {
    var i,
        text = "",
        possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
    for (i = 0; i < 10; i += 1) {
        text += possible.charAt(Math.floor(Math.random() * possible.length));
    }
    return text;
}

function auth(username, token, msg) {
	proc.find_user_on_username_token(username, token, function(err, doc) {
		if (doc) {
			msg.send(false, {token : doc.auth.token});
		} else {
			msg.send(true, null);
		}
	});
}

exports.auth = auth;