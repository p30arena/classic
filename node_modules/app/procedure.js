var DB = require('app/database');

function find_user_on_username_token(u, t, callback) {
	DB.users.findOne({'username' : u, 'auth.token' : t, 'auth.active' : true}).exec(callback);
}

function find_user_on_username_password(u, p, callback) {
	DB.users.findOne({'username' : u, 'profile.password' : p}).exec(callback);
}

function find_user_on_username(u, callback) {
	DB.users.findOne({'username' : u}).exec(callback);
}

exports.find_user_on_username_token = find_user_on_username_token;
exports.find_user_on_username_password = find_user_on_username_password;
exports.find_user_on_username = find_user_on_username;