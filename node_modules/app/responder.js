var dc = require('app/data-controller');

function extract(res) {
	return {data : res.body, ip : res.ip};
}

function BAD_REQUEST(res) {
    res.status(400).send('Bad Request');
}

function OK(res, msg) {
    if (msg === 'undefined') {
        msg = 'OK';
    }
    res.status(200).send(msg);
}

function message_factory(res) {
	this.res = res;
}
message_factory.prototype = {
	send : function(err, msg) {
		if (err) {
			BAD_REQUEST(this.res);
		} else {
			OK(this.res, msg);
		}
	}
}

function auth(req, res) {
	var raw = extract(req);
	var msg = new message_factory(res);
	dc.auth(raw.data.username, raw.data.token, msg);
}

exports.auth = auth;